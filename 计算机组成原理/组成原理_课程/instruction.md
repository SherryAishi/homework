PPT里面的指令集的学习流程（通过问题以及对应知识点的方式给出）

[wiki](https://chat.deepseek.com/a/chat/s/e5c4665d-8540-4346-b06d-1d9b472502a8)

##### *1.最基本的运算是什么？ +  $A\oplus B$范式的本质操作是什么？

最基本的运算分为：算术运算(加减乘除)，逻辑运算(与或非以及借由这三个基本运算组成的运算，如异或等)，数据移动形式的运算(与内存相关联的访存，寄存器之间的移动操作)，控制流运算(主要涉及条件分支语句中的跳转，调用，返回等)；

其中指令集的中的数据移动指：不同存储位置之间传输数据的指令，常见的就是寄存器之间数据相互迁移，还有访问内存中的数据或者是将数据存入到内存中。

> 给出Design Principle 1 : Simplicity favours regularity 也就是简单利于规律

##### *2.从当前设计角度数据和位置哪个更重要？ + *$A\oplus B= C$中数据可以在哪？计算机中数据能放在哪？

介绍寄存器操作数，并介绍了MIPS指令集的寄存器分布

> 给出Design Principle 2: Smaller is faster

##### *3.寄存器的局限在哪？哪的空间比较丰富呢？

介绍内存操作数

##### 4.为什么要独立的访存指令，为什么不能在指令中直接访存？

将寄存器和内存做对比

##### *5.除了寄存器和内存还有别的位置吗？立即数存在哪里？要为立即数也设计一套完整的运算吗？为什么立即数没有减法指令？谁负责用addi来替代subi？既然要节省指令为什么还要额外设计立即数指令？

介绍立即数以及立即数的操作指令（addi等）

> 给出 Desginer Principle 3: Make the common case fast

##### 6.最常见的立即数是不是也应该有优化？又是如何优化的？

介绍常数0，即MIPS指令集专门设计了寄存器0

##### *7.我们可以开始研究数据了么？正负数与有无符号数的处理？不足32bit的数据装入32bit的寄存器会发什么？

介绍符号拓展（sign extension）

在MIPS指令集中符号拓展出现在

1. 立即数扩展例如 addi \$t0,\$s0,0xFFFF中0xFFFF会被拓展为0xFFFFFFFF
2. 加载字节/半字：加载有符号字节(lb)或者半字(lh)到寄存器中时，会把8位数据符号拓展为32位
3. 分支指令（beq，bne）偏移量：分支指令中的16位偏移地址需要拓展位32位

介绍了指令的格式：即被编码位二进制机器码

在MIPS指令集中，被编码位32位的机器码包括指令代码（编号），寄存器的编号

具体而言是（R型）

op | rs | rt | rd | shamt | funct

6 + 5 +5 + 5 +5 + 6 = 32

op:为opcode决定指令的基本格式（R型指令，I型指令 or J型指令），rs/rt为第一/二个源寄存器（存放操作数）的编号，rd为目的寄存器（存放结果）编号，shamt是专门用于移位指令的五位字段（例如 sll \$t0,\$s1,2 将\$s1的内容左移2位存入\$t0，那么这条指令的shamt字段值为00010），funct则是用于指定具体操作的字段如add，sup等

##### *8.基础的R型指令格式是什么？R型指令能涵盖前面所有的设计吗？既然说过追求规整为什么还有I型指令？

介绍了I型指令（对于立即数的指令格式）

op | rs | rt | constant or address

6 + 5 + 5 +16

这里rs为源寄存器，rt为目的寄存器，常数则是立即数

> 给出 Design Principle 4: Good design demands good compromises 

##### 9.如何进行指令分类？如何进行运算类指令分类？如何实现数学运算类指令？如何实现逻辑运算类指令？

介绍了逻辑操作的指令，以及在MIPS指令集中对应的用法：

左移  sll 右移 srl 按位和 and，andi 

##### 10.如何对控制类指令分类？如何实现无条件控制类指令？如何实现有条件控制类指令

对于控制类指令：

```mips
beq rs,rt,L1
if(rs == rt) branch to instruction L1
bne rs,rt,L1
if(rs != rt) branch to instruction L1
j L1
unconditional jump to instruction L1
```

##### *11.控制类指令有什么特殊情况吗？知道跳不跳有什么影响么？不是跳转方向的话，会不会是条件？

介绍了Basic Blocks（基本块，程序控制流程图中的基本单元，代表一段连续执行的指令序列）

介绍了更多条件操作指令

```mips
slt rd,rs,rt
if(rs < rt) rd = 1;else rd = 0;
slti rt,rs,constant
if(rs < constant)rd =1;else rd=0;
```

##### 12.slt和slti能正常工作于所有数据场景吗？

对比了有无符号的情况

##### *13.函数调用的跳转有什么不一样吗？函数调用完整过程是什么？参数放在哪？函数里的变量放在哪？返回的地址放在哪？

介绍了函数调用（leaf）的过程：

首先参数放入寄存器，将控制转移到函数，分配空间给函数，执行函数指令，结果存储到寄存器，返回原来的地址

介绍了函数调用时会用到的寄存器

介绍了函数调用时用到的指令

jal（jump and link）用于跳转到目标地址（函数入口），并保存返回地址到\$ra寄存器

jr（jump Register）跳转到寄存器指定的地址

##### 14.不使用jal和jr能实现函数调用吗？那为什么还要设计jal和jr？不符合RISC原则？能设计一条指令完成函数调用初始操作吗？

见wiki吧，ppt上没写。

##### 15.递归嵌套/非叶程序会有什么新问题？

返回地址会被覆盖，MIPS通过栈帧管理方式解决这一问题。

##### *16.位置就是地址，地址有几种可能的生成？静态的固定地址？动态的生成地址？如何区分内外地址？什么是统一编制和独立编制？IO绝对地址？相对地址？MIPS中有几种寻址方式/地址获取方式？

介绍了分支寻址（beq，bnq），跳跃寻址（j，jal），定向寻址

##### 17.$A\oplus B = C$中的数据可以是什么？

介绍了一些字符数据以及单字节/半字操作

##### *18.I型指令能如何进行32bit的数据装载？

因为立即数段只有16bit，但是操作数都是32bit的.因此需要实现32bit数据的装载。

通过lui和ori。

lui（Load Upper Immediate）：将16位立即数加载到寄存器的高十六位，低16位置零

ori（OR Immediate）：将16位立即数与寄存器的低16位进行或操作

